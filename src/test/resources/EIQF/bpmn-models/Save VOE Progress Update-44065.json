{"bounds":{"lowerRight":{"x":1485.0,"y":700.0},"upperLeft":{"x":0.0,"y":0.0}},"resourceId":"canvas","stencil":{"id":"BPMNDiagram"},"stencilset":{"namespace":"http://b3mn.org/stencilset/bpmn2.0#","url":"../editor/stencilsets/bpmn2.0/bpmn2.0.json"},"properties":{"process_id":"SaveVOEProgressUpdate","name":"Save VOE Status Update","executionlisteners":{"executionListeners":[]},"eventlisteners":{"eventListeners":[]},"signaldefinitions":[],"messagedefinitions":[],"executionvariables":[{"variableName":"employmentRefId","variableType":"string"},{"variableName":"retrycount","variableType":"integer"},{"variableName":"resultstatus","variableType":"string"},{"variableName":"summary","variableType":"string"},{"variableName":"taskId","variableType":"string"},{"variableName":"taskName","variableType":"string"},{"variableName":"taskDueDate","variableType":"date"},{"variableName":"voeState","variableType":"string"},{"variableName":"resultjson","variableType":"string"},{"variableName":"executionId","variableType":"string"},{"variableName":"requestid","variableType":"string"},{"variableName":"applicantRefId","variableType":"string"}],"process_namespace":"http://www.activiti.org/processdef"},"childShapes":[{"bounds":{"lowerRight":{"x":135.0,"y":190.0},"upperLeft":{"x":105.0,"y":160.0}},"resourceId":"startEvent1","childShapes":[],"stencil":{"id":"StartNoneEvent"},"properties":{"overrideid":"startEvent1","executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-8DD35970-9779-4113-BEB3-9EE0659B5A8A"}]},{"bounds":{"lowerRight":{"x":740.0,"y":195.0},"upperLeft":{"x":700.0,"y":155.0}},"resourceId":"sid-B0EA86DD-0B7F-4179-AFAD-0CC200AFF151","childShapes":[],"stencil":{"id":"ExclusiveGateway"},"properties":{"overrideid":"sid-B0EA86DD-0B7F-4179-AFAD-0CC200AFF151","name":"Successful?","executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-F31EF6C8-5543-4E78-8002-A5545C189663"},{"resourceId":"sid-1E660846-A739-428F-AB36-C600541ABAC5"}]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-8B5050A2-DFC1-45BD-B830-9E2201E2D053","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":50.0,"y":40.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-893B76B0-999E-49F9-88E5-D157EC0A6137"}],"target":{"resourceId":"sid-893B76B0-999E-49F9-88E5-D157EC0A6137"},"properties":{"overrideid":"sid-8B5050A2-DFC1-45BD-B830-9E2201E2D053","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":640.0,"y":365.0},"upperLeft":{"x":540.0,"y":285.0}},"resourceId":"sid-F15382AC-8F08-4A32-9A9D-4D96901F18AD","childShapes":[],"stencil":{"id":"UserTask"},"properties":{"overrideid":"sid-F15382AC-8F08-4A32-9A9D-4D96901F18AD","name":"Error - VOE Progress Update - Retry","usertasksendemail":true,"usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"initiator"},"initiatorCanCompleteTask":false}},"formreference":{"id":44045,"name":"Error Retry Details"},"executionlisteners":{"executionListeners":[{"event":"start","className":"org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener","fields":[{"name":"language","stringValue":"javascript"},{"name":"script","stringValue":"var count  = Number(execution.getVariable(\"retrycount\")) + 1;\nexecution.setVariable(\"retrycount\", count);"}]}]},"isforcompensation":false,"asynchronousdefinition":false,"exclusivedefinition":false,"tasklisteners":{"taskListeners":[]}},"outgoing":[{"resourceId":"sid-8F2E9E7D-EFA8-4568-AB74-7A6BDF0379B0"},{"resourceId":"sid-2421A5AB-6624-4CDB-BFAF-6B1DB5C3D8E9"}]},{"bounds":{"lowerRight":{"x":490.0,"y":215.0},"upperLeft":{"x":390.0,"y":135.0}},"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6","childShapes":[],"stencil":{"id":"RestCallTask"},"properties":{"overrideid":"updateVOEProgress","name":"Update VOE Progress","restcalltask_endpoint":{"rest_url":"api/productrequest/${requestid}/applicant/${applicantRefId}/employment/${employmentRefId}/progress","http_method":"POST","endpoint_config":{"id":"1","name":"MUS Services"}},"restcalltask_request_mapping":[{"jsonPropertyName":"summary","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"summary"}},{"jsonPropertyName":"employmentRefId","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"employmentRefId"}},{"jsonPropertyName":"voeState","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"voeState"}},{"jsonPropertyName":"taskId","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"taskId"}},{"jsonPropertyName":"taskTitle","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"taskName"}},{"jsonPropertyName":"executionId","jsonPropertyType":"string","jsonPropertyValueRestResponseField":{"id":"executionId"}}],"restcalltask_response_mapping":[{"jsonPropertyName":"errorInfo","processVariableName":"resulterror","processVariableType":"string"},{"jsonPropertyName":"status","processVariableName":"resultstatus","processVariableType":"string"},{"jsonPropertyName":".","processVariableName":"resultjson","processVariableType":"string"}],"restcalltask_request_headers":[],"servicetaskfields":{"fields":[{"name":"baseEndpoint","stringValue":"1"},{"name":"baseEndpointName","stringValue":"MUS Services"},{"name":"restUrl","stringValue":"api/productrequest/${requestid}/applicant/${applicantRefId}/employment/${employmentRefId}/progress"},{"name":"httpMethod","stringValue":"POST"}]},"executionlisteners":{"executionListeners":[]},"isforcompensation":false,"asynchronousdefinition":true,"exclusivedefinition":true},"outgoing":[{"resourceId":"sid-8B5050A2-DFC1-45BD-B830-9E2201E2D053"},{"resourceId":"sid-700644DC-79BB-45CB-BAC8-2ADCA469F7A8"}]},{"bounds":{"lowerRight":{"x":640.0,"y":215.0},"upperLeft":{"x":540.0,"y":135.0}},"resourceId":"sid-893B76B0-999E-49F9-88E5-D157EC0A6137","childShapes":[],"stencil":{"id":"ScriptTask"},"properties":{"overrideid":"sid-893B76B0-999E-49F9-88E5-D157EC0A6137","name":"Evaluate Response","scriptformat":"javascript","scripttext":"print(\"VOE PROGRESS UPDATE RESULT:\");\nprint(execution.getVariable(\"resultjson\"));\nvar count = Number(execution.getVariable(\"retrycount\")) + 1;\nexecution.setVariable(\"retrycount\",count);","executionlisteners":{"executionListeners":[]},"isforcompensation":false,"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-51960698-5A8A-4ECE-8452-E639F1113E00"}]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-51960698-5A8A-4ECE-8452-E639F1113E00","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":50.0,"y":40.0},{"x":20.0,"y":20.0}],"outgoing":[{"resourceId":"sid-B0EA86DD-0B7F-4179-AFAD-0CC200AFF151"}],"target":{"resourceId":"sid-B0EA86DD-0B7F-4179-AFAD-0CC200AFF151"},"properties":{"overrideid":"sid-51960698-5A8A-4ECE-8452-E639F1113E00","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":640.0,"y":485.0},"upperLeft":{"x":540.0,"y":405.0}},"resourceId":"sid-BDD5A696-4F8B-4CDA-A708-820F2BAF13E9","childShapes":[],"stencil":{"id":"UserTask"},"properties":{"overrideid":"sid-BDD5A696-4F8B-4CDA-A708-820F2BAF13E9","name":"Error - VOE Progress Update - Please Resolve!","usertasksendemail":true,"usertaskassignment":{"assignment":{"type":"idm","idm":{"type":"initiator"},"initiatorCanCompleteTask":false}},"formreference":{"id":44045,"name":"Error Retry Details"},"executionlisteners":{"executionListeners":[{"event":"end","className":"org.activiti.engine.impl.bpmn.listener.ScriptExecutionListener","fields":[{"name":"script","stringValue":"execution.setVariable(\"retrycount\",0)"},{"name":"language","stringValue":"javascript"}]}]},"isforcompensation":false,"asynchronousdefinition":false,"exclusivedefinition":false,"tasklisteners":{"taskListeners":[]}},"outgoing":[{"resourceId":"sid-75FE32A5-A010-46EA-9BC6-F37AC0359780"}]},{"bounds":{"lowerRight":{"x":740.0,"y":345.0},"upperLeft":{"x":700.0,"y":305.0}},"resourceId":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB","childShapes":[],"stencil":{"id":"ExclusiveGateway"},"properties":{"overrideid":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB","name":"Exceed Retries?","executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-24D360A2-0C05-4457-B390-3B182F16CBEC"},{"resourceId":"sid-22B06C31-AFDB-43BC-9CFA-3C0819FB3BF9"}]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-75FE32A5-A010-46EA-9BC6-F37AC0359780","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":50.0,"y":40.0},{"x":440.0,"y":445.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"}],"target":{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"},"properties":{"overrideid":"sid-75FE32A5-A010-46EA-9BC6-F37AC0359780","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":908.0,"y":189.0},"upperLeft":{"x":880.0,"y":161.0}},"resourceId":"sid-D44D3BDC-E34B-44F1-8619-DC4DA3563D89","childShapes":[],"stencil":{"id":"EndNoneEvent"},"properties":{"overrideid":"sid-D44D3BDC-E34B-44F1-8619-DC4DA3563D89","executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-24D360A2-0C05-4457-B390-3B182F16CBEC","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":20.0,"y":20.0},{"x":720.0,"y":445.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-BDD5A696-4F8B-4CDA-A708-820F2BAF13E9"}],"target":{"resourceId":"sid-BDD5A696-4F8B-4CDA-A708-820F2BAF13E9"},"properties":{"overrideid":"exceedretries","name":"Yes","executionlisteners":{"executionListeners":[]},"conditionsequenceflow":{"expression":{"index":"0","leftRestResponseId":"retrycount","rightValue":"2","operator":">","type":"variables"}}}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-22B06C31-AFDB-43BC-9CFA-3C0819FB3BF9","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":20.0,"y":20.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-F15382AC-8F08-4A32-9A9D-4D96901F18AD"}],"target":{"resourceId":"sid-F15382AC-8F08-4A32-9A9D-4D96901F18AD"},"properties":{"overrideid":"sid-22B06C31-AFDB-43BC-9CFA-3C0819FB3BF9","name":"No","executionlisteners":{"executionListeners":[]},"defaultflow":true}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-29901940-4556-4CAD-8A23-6808962C25CA","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":15.5,"y":15.5},{"x":440.0,"y":356.4825114029586},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"}],"target":{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"},"properties":{"overrideid":"sid-29901940-4556-4CAD-8A23-6808962C25CA","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-87E479C4-52A7-406A-8C43-03E52A2F9FB7","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":50.0,"y":40.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"}],"target":{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"},"properties":{"overrideid":"sid-87E479C4-52A7-406A-8C43-03E52A2F9FB7","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":355.0,"y":215.0},"upperLeft":{"x":255.0,"y":135.0}},"resourceId":"sid-47411F58-83E3-4EF0-BE3F-37C14422A3A0","childShapes":[],"stencil":{"id":"ScriptTask"},"properties":{"overrideid":"sid-47411F58-83E3-4EF0-BE3F-37C14422A3A0","name":"Init Request and Create Summary","scriptformat":"javascript","scripttext":"execution.setVariable(\"retrycount\",0);\nexecution.setVariable(\"issuccessful\",true);\n\n//var d = new Date(execution.getVariable(\"taskDueDate\"));\nvar d = new Date();\nvar dd = (d.getMonth()+1) + \"/\" + d.getDate() + \"/\" + d.getFullYear();\nvar summ = dd + \"  \" + execution.getVariable(\"summary\");\n\nexecution.setVariable(\"summary\",summ);\nprint(\"STATUS UPDATE\");\nprint(summ);\n\nvar voeState = (execution.getVariable(\"voecompleted\") === true) ? \"COMPLETED\" : execution.getVariable(\"voeState\");\nexecution.setVariable(\"voeState\",voeState);","executionlisteners":{"executionListeners":[]},"isforcompensation":false,"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-87E479C4-52A7-406A-8C43-03E52A2F9FB7"}]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-8DD35970-9779-4113-BEB3-9EE0659B5A8A","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":15.0,"y":15.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-47411F58-83E3-4EF0-BE3F-37C14422A3A0"}],"target":{"resourceId":"sid-47411F58-83E3-4EF0-BE3F-37C14422A3A0"},"properties":{"overrideid":"sid-8DD35970-9779-4113-BEB3-9EE0659B5A8A","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-5D07DF20-D4E3-4D79-9C54-FE6B4C9AF5AF","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":15.0,"y":15.0},{"x":20.0,"y":20.0}],"outgoing":[{"resourceId":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB"}],"target":{"resourceId":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB"},"properties":{"overrideid":"sid-5D07DF20-D4E3-4D79-9C54-FE6B4C9AF5AF","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-F31EF6C8-5543-4E78-8002-A5545C189663","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":20.0,"y":20.0},{"x":14.0,"y":14.0}],"outgoing":[{"resourceId":"sid-D44D3BDC-E34B-44F1-8619-DC4DA3563D89"}],"target":{"resourceId":"sid-D44D3BDC-E34B-44F1-8619-DC4DA3563D89"},"properties":{"overrideid":"sid-F31EF6C8-5543-4E78-8002-A5545C189663","name":"Yes","executionlisteners":{"executionListeners":[]},"defaultflow":true}},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-1E660846-A739-428F-AB36-C600541ABAC5","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":20.0,"y":20.0},{"x":20.0,"y":20.0}],"outgoing":[{"resourceId":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB"}],"target":{"resourceId":"sid-E47487B2-A1A2-488B-82D5-9C9A95A1B8AB"},"properties":{"overrideid":"notsucessful","name":"No","executionlisteners":{"executionListeners":[]},"conditionsequenceflow":{"expression":{"index":"0","leftRestResponseId":"resultstatus","rightValue":"SUCCESS","operator":"!=","type":"variables"}}}},{"bounds":{"lowerRight":{"x":473.3248986436919,"y":230.7069797841498},"upperLeft":{"x":443.3248986436919,"y":200.7069797841498}},"resourceId":"sid-700644DC-79BB-45CB-BAC8-2ADCA469F7A8","childShapes":[],"stencil":{"id":"BoundaryErrorEvent"},"dockers":[{"x":53.32489864369188,"y":65.70697978414981}],"properties":{"overrideid":"noResponse","name":"No Response","cancelactivity":true,"executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-5D07DF20-D4E3-4D79-9C54-FE6B4C9AF5AF"}]},{"bounds":{"lowerRight":{"x":172.0,"y":212.0},"upperLeft":{"x":128.0,"y":212.0}},"resourceId":"sid-8F2E9E7D-EFA8-4568-AB74-7A6BDF0379B0","childShapes":[],"stencil":{"id":"SequenceFlow"},"dockers":[{"x":50.0,"y":40.0},{"x":440.0,"y":325.0},{"x":50.0,"y":40.0}],"outgoing":[{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"}],"target":{"resourceId":"sid-6CDC5DA2-950E-45F4-BDD6-8F28B8B844D6"},"properties":{"overrideid":"sid-8F2E9E7D-EFA8-4568-AB74-7A6BDF0379B0","executionlisteners":{"executionListeners":[]}}},{"bounds":{"lowerRight":{"x":555.2394604905069,"y":371.4825114029586},"upperLeft":{"x":524.2394604905069,"y":340.4825114029586}},"resourceId":"sid-2421A5AB-6624-4CDB-BFAF-6B1DB5C3D8E9","childShapes":[],"stencil":{"id":"BoundaryTimerEvent"},"dockers":[{"x":-15.760539509493128,"y":55.48251140295861}],"properties":{"overrideid":"sid-2421A5AB-6624-4CDB-BFAF-6B1DB5C3D8E9","cancelactivity":true,"timerdurationdefinition":"PT1M","executionlisteners":{"executionListeners":[]},"asynchronousdefinition":false,"exclusivedefinition":false},"outgoing":[{"resourceId":"sid-29901940-4556-4CAD-8A23-6808962C25CA"}]}]}